<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8" />
    <link rel="stylesheet" href="globals.css" />
    <link rel="stylesheet" href="styleguide.css" />
    <link rel="stylesheet" href="/stylesheets/homepage.css" />
  </head>
  <body>
    <div class="homepage">
      <div class="overlap-wrapper">
        <div class="overlap">
          <div class="main-section"></div>
          <div class="rectangle"></div>
          <div class="div"></div>
          <p class="crafted-with-passion">
            <span class="text-wrapper">Crafted with </span>
            <span class="span">Passion<br /></span>
            <span class="text-wrapper">Baked with </span>
            <span class="span">Love</span>
          </p>
          <img class="element-education-shapes" src="/image/3D Education Shapes School Enrolment Poster (2) 1.png" />
          <img class="element-d-education-shapes" src="/image/3D Education Shapes School Enrolment Poster 1.png" />
          <img class="img" src="/image/3D Education Shapes School Enrolment Poster (1) 1.png" />

          <div class="container">
            <img class="line" src="/image/Line 14.png"/>
            <img class="line2" src="/image/Line 14.png"/>
          </div>

          <div class="header-user">
            <div class="overlap-group">
              <button class="logo" >Jeunesse.</button>
              <button class="spham" >Sản phẩm</button>
              <button class="aboutus" >Về Jeunesse</button>
              <button class="login">Đăng nhập</button>
              <button class="group"><span class="text-wrapper-5">Giỏ hàng</span></button>
              <button class="group-2"></button>
              <div class="div-wrapper"><div class="text-wrapper-6">0</div></div>
            </div>
          </div>
          <div class="footer-ngi-dng">
            <button class="text-wrapper-7">Jeunesse.</button>
            <div class="frame">
              <div class="flexcontainer">
                <p class="text-i">
                  <span class="text-wrapper-8">Hotline<br /></span>
                </p>
                <p class="text-i"><span class="text-wrapper-9">(+84) 824048293</span></p>
              </div>
              <div class="flexcontainer">
                <p class="text-i">
                  <span class="text-wrapper-8">Location<br /></span>
                </p>
                <p class="text-i"><span class="text-wrapper-9">166 Cầu Giấy, Hà Nội </span></p>
              </div>
            </div>
            <div class="frame-2">
              <button class="text-wrapper-10">Về Jeunesse</button>
              <button class="text-wrapper-11">Sản phẩm</button>
              <button class="text-wrapper-12">Giỏ hàng</button>
            </div>
            <p class="p">© 2024 Jeunesse All Rights Reserved.</p>
          </div>
          <div class="overlap-group-wrapper">
            <div class="overlap-2">
              <div class="group-3">
                <p class="jeunesse-ngh-thu-t-b">
                  Ở Jeunesse, nghệ thuật bánh Entremet tinh tế là sự kết hợp hoàn hảo giữa tay nghề bậc thầy và sáng tạo
                  không giới hạn. Mỗi chiếc bánh là một tác phẩm nghệ thuật, với nhiều lớp bánh mềm mịn, mousse ngọt
                  ngào và nhân phong phú.<br />Nguyên liệu thượng hạng và kỹ thuật chế biến đỉnh cao tạo nên hương vị
                  sang trọng. Khi thưởng thức, bạn sẽ cảm nhận sự hòa quyện tuyệt vời giữa vị ngọt, chua, béo và thơm,
                  tạo nên một trải nghiệm ẩm thực đẳng cấp và tinh tế.
                </p>
                <p class="ngh-thu-t-b-nh">Nghệ thuật bánh Entremet tinh tế, <br />hương vị thượng hạng</p>
                <div class="overlap-group-2">
                  <img class="image" src="/image/image 5.png" /> <img class="rectangle-2" src="/image/Rectangle 12.png" />
                </div>
                <img class="element-education-shapes-2" src="/image/3D Education Shapes School Enrolment Poster (2) 3.png" />
                <p class="text-wrapper-13">Mỗi miếng bánh, một tác phẩm nghệ thuật</p>
                <p class="text-wrapper-14">
                  Mỗi chiếc bánh không chỉ mang đến hương vị tuyệt vời mà còn là sự thể hiện của nghệ thuật trình bày
                  tinh tế. Được trang trí bằng hoa quả tươi ngon, chocolate thượng hạng và những chi tiết tinh xảo, mỗi
                  miếng bánh là một trải nghiệm thị giác và vị giác khó quên. Hãy để Jeunesse mang đến cho bạn sự tận
                  hưởng đẳng cấp trong từng miếng bánh, nơi nghệ thuật và hương vị giao thoa hoàn hảo.
                </p>
                <button class="input-field"><div class="text-wrapper-15">Sản phẩm</div></button>
              </div>
              <button class="input-field-2"><div class="text-wrapper-16">Về Jeunesse</div></button>
            </div>
          </div>

        <div class="container2">
          <img class="line3" src="/image/Line 14.png"/>
          <img class="line4" src="/image/Line 14.png"/>
        </div>

        <div class="banner-homepage">
          <div class="slider">
            <div class="slides">
              <div class="slide">
                <img src="/image/banner 1.png" alt="Banner 1" />
              </div>
              <div class="slide">
                <img src="/image/banner 2.png" alt="Banner 2" />
              </div>
              <div class="slide">
                <img src="/image/banner 3.png" alt="Banner 3" />
              </div>
            </div>
          </div>
        </div>

        </div>
        </div>
      </div>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        // Lấy tất cả các button trên trang
        const buttons = document.querySelectorAll('button');

        // Định nghĩa đường dẫn tương ứng cho từng button
        const buttonRoutes = {
          'Jeunesse.': '/',
          'Sản phẩm': '/products/banhle',
          'Về Jeunesse': '/about',
          'Giỏ hàng': '/cart'
        };

        // Thêm sự kiện click cho từng button
        buttons.forEach(button => {
          button.addEventListener('click', function() {
            const buttonText = button.textContent.trim();
            if (buttonRoutes[buttonText]) {
              window.location.href = buttonRoutes[buttonText];
            }
          });
        });
      });

      const fetchCart = () => {
      return new Promise((resolve, reject) => {
        fetch('/cart/get-cart')
          .then(response => {
            if (!response.ok) {
              throw new Error('Network response was not ok');
            }
            return response.json();
          })
          .then(cart => {
            resolve(cart);
          })
          .catch(error => {
            console.error('Error fetching cart:', error);
            reject(error);
          });
    });
  };

    // Hàm cập nhật số lượng sản phẩm trong giỏ hàng (number-count và text-wrapper-6)
    const updateCartCount = (cart) => {
      const cartCountElement = document.querySelector('.number-count'); // number-count trong cart.html
      const homepageCartCountElement = document.querySelector('.text-wrapper-6'); // text-wrapper-6 trong homepage.html

      let totalQuantity = 0;
      cart.forEach(product => {
        totalQuantity += product.quantity;
      });

      // Cập nhật cả hai phần tử nếu chúng tồn tại
      if (cartCountElement) {
        cartCountElement.textContent = totalQuantity;
      }
      if (homepageCartCountElement) {
        homepageCartCountElement.textContent = totalQuantity;
      }
    };

    // Hàm khởi tạo trang chủ
    const initHomepage = async () => {
      try {
        const cart = await fetchCart();
        updateCartCount(cart);
      } catch (error) {
        console.error('Error initializing homepage:', error);
      }
    };

    // Gọi hàm khởi tạo khi trang tải xong
    initHomepage();

        fetch('/auth/check-login')
            .then(response => response.json())
            .then(data => {
                if (data.loggedIn) {
                    // Nếu đã đăng nhập, hiển thị nút Profile và Đăng xuất, ẩn nút Đăng nhập
                    document.querySelector('.group-2').style.display = 'block';
                    document.querySelector('.login').style.display = 'none';
                } else {
                    // Nếu chưa đăng nhập, hiển thị nút Đăng nhập
                    document.querySelector('.login').style.display = 'block';
                    document.querySelector('.group-2').style.display = 'none';
                }
            })
            .catch(error => {
                console.error('Error checking login status:', error);
            });

        // Xử lý sự kiện khi người dùng click vào "Đăng nhập"
        document.querySelector('.login').addEventListener('click', function() {
            window.location.href = '/login'; // Chuyển hướng đến trang đăng nhập
        });

        // Xử lý sự kiện khi người dùng click vào "Profile"
        document.querySelector('.group-2').addEventListener('click', function() {
            window.location.href = '/profile'; // Chuyển hướng đến trang profile
        });
    </script>
  </body>
</html>
